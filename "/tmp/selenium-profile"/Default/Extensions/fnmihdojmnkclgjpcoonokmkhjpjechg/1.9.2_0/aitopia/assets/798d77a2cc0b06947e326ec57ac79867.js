import{r as $}from"./7afa0b1c12b13d1626d2f2c8e2aa1ee0.js";import{p as Kt}from"./95c5528581b0856eaa0cfd2aa93cc17d.js";import{b as Gt}from"./ee34ee5b9c5753935e961eee233a62fc.js";import{j as Yt}from"./a2d51818e134dfda6f32266bb36e093e.js";import{d as Jt,l as Qt,c as Qr}from"./1a1e12b85f9de6c453175456e6b03dc3.js";import{l as en}from"./3a41cd8c5af9dd3910506c9a4099ba81.js";import{d as rn}from"./88e2aedb43ec1d2e2774299e2ae7941a.js";import{l as et}from"./44b95ac80240ad7543fb4b924bb1567f.js";var Q={},sr={},M={},tn=$,V=Kt();M.defer=nn;M.when=V.resolve;M.resolve=V.resolve;M.all=V.all;M.props=V.props;M.reject=V.reject;M.promisify=V.promisify;M.mapSeries=V.mapSeries;M.attempt=V.attempt;M.nfcall=function(e){var r=Array.prototype.slice.call(arguments,1),t=V.promisify(e);return t.apply(null,r)};V.prototype.fail=V.prototype.caught;V.prototype.also=function(e){return this.then(function(r){var t=tn.extend({},r,e(r));return V.props(t)})};function nn(){var e,r,t=new V.Promise(function(a,i){e=a,r=i});return{resolve:e,reject:r,promise:t}}var E={},an=$,F=E.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function un(e,r){return r=r||{},{type:F.document,children:e,notes:r.notes||new Ae({}),comments:r.comments||[]}}function ln(e,r){r=r||{};var t=r.indent||{};return{type:F.paragraph,children:e,styleId:r.styleId||null,styleName:r.styleName||null,numbering:r.numbering||null,alignment:r.alignment||null,indent:{start:t.start||null,end:t.end||null,firstLine:t.firstLine||null,hanging:t.hanging||null}}}function sn(e,r){return r=r||{},{type:F.run,children:e,styleId:r.styleId||null,styleName:r.styleName||null,isBold:!!r.isBold,isUnderline:!!r.isUnderline,isItalic:!!r.isItalic,isStrikethrough:!!r.isStrikethrough,isAllCaps:!!r.isAllCaps,isSmallCaps:!!r.isSmallCaps,verticalAlignment:r.verticalAlignment||rt.baseline,font:r.font||null,fontSize:r.fontSize||null,highlight:r.highlight||null}}var rt={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function on(e){return{type:F.text,value:e}}function cn(){return{type:F.tab}}function fn(e){return{type:F.checkbox,checked:e.checked}}function mn(e,r){return{type:F.hyperlink,children:e,href:r.href,anchor:r.anchor,targetFrame:r.targetFrame}}function pn(e){return{type:F.noteReference,noteType:e.noteType,noteId:e.noteId}}function Ae(e){this._notes=an.indexBy(e,function(r){return tt(r.noteType,r.noteId)})}Ae.prototype.resolve=function(e){return this.findNoteByKey(tt(e.noteType,e.noteId))};Ae.prototype.findNoteByKey=function(e){return this._notes[e]||null};function dn(e){return{type:F.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function hn(e){return{type:F.commentReference,commentId:e.commentId}}function vn(e){return{type:F.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function tt(e,r){return e+"-"+r}function yn(e){return{type:F.image,read:function(r){return r?e.readImage(r):e.readImage().then(function(t){return Buffer.from(t)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(r){return Buffer.from(r)})},altText:e.altText,contentType:e.contentType}}function gn(e,r){return r=r||{},{type:F.table,children:e,styleId:r.styleId||null,styleName:r.styleName||null}}function wn(e,r){return r=r||{},{type:F.tableRow,children:e,isHeader:r.isHeader||!1}}function bn(e,r){return r=r||{},{type:F.tableCell,children:e,colSpan:r.colSpan==null?1:r.colSpan,rowSpan:r.rowSpan==null?1:r.rowSpan}}function or(e){return{type:F.break,breakType:e}}function Tn(e){return{type:F.bookmarkStart,name:e.name}}E.document=E.Document=un;E.paragraph=E.Paragraph=ln;E.run=E.Run=sn;E.text=E.Text=on;E.tab=E.Tab=cn;E.checkbox=E.Checkbox=fn;E.Hyperlink=mn;E.noteReference=E.NoteReference=pn;E.Notes=Ae;E.Note=dn;E.commentReference=hn;E.comment=vn;E.Image=yn;E.Table=gn;E.TableRow=wn;E.TableCell=bn;E.lineBreak=or("line");E.pageBreak=or("page");E.columnBreak=or("column");E.BookmarkStart=Tn;E.verticalAlignment=rt;var Z={},xe=$;Z.Result=J;Z.success=En;Z.warning=kn;Z.error=xn;function J(e,r){this.value=e,this.messages=r||[]}J.prototype.map=function(e){return new J(e(this.value),this.messages)};J.prototype.flatMap=function(e){var r=e(this.value);return new J(r.value,cr([this,r]))};J.prototype.flatMapThen=function(e){var r=this;return e(this.value).then(function(t){return new J(t.value,cr([r,t]))})};J.combine=function(e){var r=xe.flatten(xe.pluck(e,"value")),t=cr(e);return new J(r,t)};function En(e){return new J(e,[])}function kn(e){return{type:"warning",message:e}}function xn(e){return{type:"error",message:e.message,error:e}}function cr(e){var r=[];return xe.flatten(xe.pluck(e,"messages"),!0).forEach(function(t){Rn(r,t)||r.push(t)}),r}function Rn(e,r){return xe.find(e,Sn.bind(null,r))!==void 0}function Sn(e,r){return e.type===r.type&&e.message===r.message}var Ie={},In=Gt,On=Yt;Ie.openArrayBuffer=Pn;Ie.splitPath=Nn;Ie.joinPath=Cn;function Pn(e){return On.loadAsync(e).then(function(r){function t(s){return r.file(s)!==null}function a(s,c){return r.file(s).async("uint8array").then(function(f){if(c==="base64")return In.fromByteArray(f);if(c){var d=new TextDecoder(c);return d.decode(f)}else return f})}function i(s,c){r.file(s,c)}function o(){return r.generateAsync({type:"arraybuffer"})}return{exists:t,read:a,write:i,toArrayBuffer:o}})}function Nn(e){var r=e.lastIndexOf("/");return r===-1?{dirname:"",basename:e}:{dirname:e.substring(0,r),basename:e.substring(r+1)}}function Cn(){var e=Array.prototype.filter.call(arguments,function(t){return t}),r=[];return e.forEach(function(t){/^\//.test(t)?r=[t]:r.push(t)}),r.join("/")}var fr={},ne={},ve={},De=$;ve.Element=ye;ve.element=function(e,r,t){return new ye(e,r,t)};ve.text=function(e){return{type:"text",value:e}};var nt=ve.emptyElement={first:function(){return null},firstOrEmpty:function(){return nt},attributes:{},children:[]};function ye(e,r,t){this.type="element",this.name=e,this.attributes=r||{},this.children=t||[]}ye.prototype.first=function(e){return De.find(this.children,function(r){return r.name===e})};ye.prototype.firstOrEmpty=function(e){return this.first(e)||nt};ye.prototype.getElementsByTagName=function(e){var r=De.filter(this.children,function(t){return t.name===e});return at(r)};ye.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var Bn={getElementsByTagName:function(e){return at(De.flatten(this.map(function(r){return r.getElementsByTagName(e)},!0)))}};function at(e){return De.extend(e,Bn)}var it={},mr={},$n=Qt,Mn=Jt;function _n(e){var r=null,t=new $n.DOMParser({errorHandler:function(i,o){r={level:i,message:o}}}),a=t.parseFromString(e);if(r===null)return a;throw new Error(r.level+": "+r.message)}mr.parseFromString=_n;mr.Node=Mn.Node;var tr=M,Or=$,ut=mr,lt=ve,Fn=lt.Element;it.readString=qn;var Pr=ut.Node;function qn(e,r){r=r||{};try{var t=ut.parseFromString(e,"text/xml")}catch(s){return tr.reject(s)}if(t.documentElement.tagName==="parsererror")return tr.resolve(new Error(t.documentElement.textContent));function a(s){switch(s.nodeType){case Pr.ELEMENT_NODE:return i(s);case Pr.TEXT_NODE:return lt.text(s.nodeValue)}}function i(s){var c=o(s),f=[];Or.forEach(s.childNodes,function(p){var T=a(p);T&&f.push(T)});var d={};return Or.forEach(s.attributes,function(p){d[o(p)]=p.value}),new Fn(c,d,f)}function o(s){if(s.namespaceURI){var c=r[s.namespaceURI],f;return c?f=c+":":f="{"+s.namespaceURI+"}",f+s.localName}else return s.localName}return tr.resolve(a(t.documentElement))}var st={},Nr=$,Hn=en;st.writeString=An;function An(e,r){var t=Nr.invert(r),a={element:o,text:Dn};function i(f,d){return a[d.type](f,d)}function o(f,d){var p=f.element(s(d.name),d.attributes);d.children.forEach(function(T){i(p,T)})}function s(f){var d=/^\{(.*)\}(.*)$/.exec(f);if(d){var p=t[d[1]];return p+(p===""?"":":")+d[2]}else return f}function c(f){var d=Hn.create(s(f.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return Nr.forEach(r,function(p,T){var N="xmlns"+(T===""?"":":"+T);d.attribute(N,p)}),f.children.forEach(function(p){i(d,p)}),d.end()}return c(e)}function Dn(e,r){e.text(r.value)}var We=ve;ne.Element=We.Element;ne.element=We.element;ne.emptyElement=We.emptyElement;ne.text=We.text;ne.readString=it.readString;ne.writeString=st.writeString;var Wn=$,Xn=M,Ln=ne;fr.read=ot;fr.readXmlFromZipFile=Un;var jn={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function ot(e){return Ln.readString(e,jn).then(function(r){return ct(r)[0]})}function Un(e,r){return e.exists(r)?e.read(r,"utf-8").then(Vn).then(ot):Xn.resolve(null)}function Vn(e){return e.replace(/^\uFEFF/g,"")}function ct(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.first("mc:Fallback").children:(e.children=Wn.flatten(e.children.map(ct,!0)),[e]):[e]}var pr={},dr={};dr.uriToZipEntryName=Zn;dr.replaceFragment=zn;function Zn(e,r){return r.charAt(0)==="/"?r.substr(1):e+"/"+r}function zn(e,r){var t=e.indexOf("#");return t!==-1&&(e=e.substring(0,t)),e+"#"+r}pr.createBodyReader=Gn;pr._readNumberingProperties=mt;var Cr=rn,K=$,B=E,ft=Z.Result,re=Z.warning,Kn=ne,Br=dr;function Gn(e){return{readXmlElement:function(r){return new $r(e).readXmlElement(r)},readXmlElements:function(r){return new $r(e).readXmlElements(r)}}}function $r(e){var r=[],t=[],a=[],i=e.relationships,o=e.contentTypes,s=e.docxFile,c=e.files,f=e.numbering,d=e.styles;function p(n){var m=n.map(T);return Mr(m)}function T(n){if(n.type==="element"){var m=er[n.name];if(m)return m(n);if(!Object.prototype.hasOwnProperty.call(Jn,n.name)){var v=re("An unrecognised element was ignored: "+n.name);return Ee([v])}}return ke()}function N(n){return oe(n).map(function(m){return{type:"paragraphProperties",styleId:m.styleId,styleName:m.name,alignment:n.firstOrEmpty("w:jc").attributes["w:val"],numbering:mt(m.styleId,n.firstOrEmpty("w:numPr"),f),indent:H(n.firstOrEmpty("w:ind"))}})}function H(n){return{start:n.attributes["w:start"]||n.attributes["w:left"],end:n.attributes["w:end"]||n.attributes["w:right"],firstLine:n.attributes["w:firstLine"],hanging:n.attributes["w:hanging"]}}function O(n){return ce(n).map(function(m){var v=n.firstOrEmpty("w:sz").attributes["w:val"],b=/^[0-9]+$/.test(v)?parseInt(v,10)/2:null;return{type:"runProperties",styleId:m.styleId,styleName:m.name,verticalAlignment:n.firstOrEmpty("w:vertAlign").attributes["w:val"],font:n.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:b,isBold:R(n.first("w:b")),isUnderline:g(n.first("w:u")),isItalic:R(n.first("w:i")),isStrikethrough:R(n.first("w:strike")),isAllCaps:R(n.first("w:caps")),isSmallCaps:R(n.first("w:smallCaps")),highlight:ue(n.firstOrEmpty("w:highlight").attributes["w:val"])}})}function g(n){if(n){var m=n.attributes["w:val"];return m!==void 0&&m!=="false"&&m!=="0"&&m!=="none"}else return!1}function R(n){if(n){var m=n.attributes["w:val"];return m!=="false"&&m!=="0"}else return!1}function A(n){return n!=="false"&&n!=="0"}function ue(n){return!n||n==="none"?null:n}function oe(n){return P(n,"w:pStyle","Paragraph",d.findParagraphStyleById)}function ce(n){return P(n,"w:rStyle","Run",d.findCharacterStyleById)}function le(n){return P(n,"w:tblStyle","Table",d.findTableStyleById)}function P(n,m,v,b){var I=[],C=n.first(m),X=null,pe=null;if(C&&(X=C.attributes["w:val"],X)){var Ir=b(X);Ir?pe=Ir.name:I.push(zt(v,X))}return Ne({styleId:X,name:pe},I)}function L(n){var m=n.attributes["w:fldCharType"];if(m==="begin")r.push({type:"begin",fldChar:n}),t=[];else if(m==="end"){var v=r.pop();if(v.type==="begin"&&(v=fe(v)),v.type==="checkbox")return U(B.checkbox({checked:v.checked}))}else if(m==="separate"){var b=r.pop(),I=fe(b);r.push(I)}return ke()}function be(){var n=K.last(r.filter(function(m){return m.type==="hyperlink"}));return n?n.options:null}function fe(n){return me(t.join(""),n.type==="begin"?n.fldChar:Kn.emptyElement)}function me(n,m){var v=/\s*HYPERLINK "(.*)"/.exec(n);if(v)return{type:"hyperlink",options:{href:v[1]}};var b=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(n);if(b)return{type:"hyperlink",options:{anchor:b[1]}};var I=/\s*FORMCHECKBOX\s*/.exec(n);if(I){var C=m.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),X=C.first("w:checked"),pe=X==null?R(C.first("w:default")):R(X);return{type:"checkbox",checked:pe}}return{type:"unknown"}}function Te(n){return t.push(n.text()),ke()}function Qe(n){var m=n.attributes["w:font"],v=n.attributes["w:char"],b=Cr.hex(m,v);return b==null&&/^F0..$/.test(v)&&(b=Cr.hex(m,v.substring(2))),b==null?Ee([re("A w:sym element with an unsupported character was ignored: char "+v+" in font "+m)]):U(new B.Text(b.string))}function Oe(n){return function(m){var v=m.attributes["w:id"];return U(new B.NoteReference({noteType:n,noteId:v}))}}function Pe(n){return U(B.commentReference({commentId:n.attributes["w:id"]}))}function j(n){return p(n.children)}var er={"w:p":function(n){var m=n.firstOrEmpty("w:pPr"),v=!!m.firstOrEmpty("w:rPr").first("w:del");if(v)return n.children.forEach(function(I){a.push(I)}),ke();var b=n.children;return a.length>0&&(b=a.concat(b),a=[]),_.map(N(m),p(b),function(I,C){return new B.Paragraph(C,I)}).insertExtra()},"w:r":function(n){return _.map(O(n.firstOrEmpty("w:rPr")),p(n.children),function(m,v){var b=be();return b!==null&&(v=[new B.Hyperlink(v,b)]),new B.Run(v,m)})},"w:fldChar":L,"w:instrText":Te,"w:t":function(n){return U(new B.Text(n.text()))},"w:tab":function(n){return U(new B.Tab)},"w:noBreakHyphen":function(){return U(new B.Text("‑"))},"w:softHyphen":function(n){return U(new B.Text("­"))},"w:sym":Qe,"w:hyperlink":function(n){var m=n.attributes["r:id"],v=n.attributes["w:anchor"];return p(n.children).map(function(b){function I(X){var pe=n.attributes["w:tgtFrame"]||null;return new B.Hyperlink(b,K.extend({targetFrame:pe},X))}if(m){var C=i.findTargetByRelationshipId(m);return v&&(C=Br.replaceFragment(C,v)),I({href:C})}else return v?I({anchor:v}):b})},"w:tbl":rr,"w:tr":h,"w:tc":y,"w:footnoteReference":Oe("footnote"),"w:endnoteReference":Oe("endnote"),"w:commentReference":Pe,"w:br":function(n){var m=n.attributes["w:type"];return m==null||m==="textWrapping"?U(B.lineBreak):m==="page"?U(B.pageBreak):m==="column"?U(B.columnBreak):Ee([re("Unsupported break type: "+m)])},"w:bookmarkStart":function(n){var m=n.attributes["w:name"];return m==="_GoBack"?ke():U(new B.BookmarkStart({name:m}))},"mc:AlternateContent":function(n){return j(n.first("mc:Fallback"))},"w:sdt":function(n){var m=n.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(m){var v=m.first("wordml:checked"),b=!!v&&A(v.attributes["wordml:val"]);return U(B.checkbox({checked:b}))}else return p(n.firstOrEmpty("w:sdtContent").children)},"w:ins":j,"w:object":j,"w:smartTag":j,"w:drawing":j,"w:pict":function(n){return j(n).toExtra()},"v:roundrect":j,"v:shape":j,"v:textbox":j,"w:txbxContent":j,"wp:inline":S,"wp:anchor":S,"v:imagedata":Zt,"v:group":j,"v:rect":j};return{readXmlElement:T,readXmlElements:p};function rr(n){var m=u(n.firstOrEmpty("w:tblPr"));return p(n.children).flatMap(k).flatMap(function(v){return m.map(function(b){return B.Table(v,b)})})}function u(n){return le(n).map(function(m){return{styleId:m.styleId,styleName:m.name}})}function h(n){var m=n.firstOrEmpty("w:trPr"),v=!!m.first("w:tblHeader");return p(n.children).map(function(b){return B.TableRow(b,{isHeader:v})})}function y(n){return p(n.children).map(function(m){var v=n.firstOrEmpty("w:tcPr"),b=v.firstOrEmpty("w:gridSpan").attributes["w:val"],I=b?parseInt(b,10):1,C=B.TableCell(m,{colSpan:I});return C._vMerge=w(v),C})}function w(n){var m=n.first("w:vMerge");if(m){var v=m.attributes["w:val"];return v==="continue"||!v}else return null}function k(n){var m=K.any(n,function(I){return I.type!==B.types.tableRow});if(m)return Ne(n,[re("unexpected non-row element in table, cell merging may be incorrect")]);var v=K.any(n,function(I){return K.any(I.children,function(C){return C.type!==B.types.tableCell})});if(v)return Ne(n,[re("unexpected non-cell element in table row, cell merging may be incorrect")]);var b={};return n.forEach(function(I){var C=0;I.children.forEach(function(X){X._vMerge&&b[C]?b[C].rowSpan++:(b[C]=X,X._vMerge=!1),C+=X.colSpan})}),n.forEach(function(I){I.children=I.children.filter(function(C){return!C._vMerge}),I.children.forEach(function(C){delete C._vMerge})}),U(n)}function S(n){var m=n.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return Mr(m.map(W.bind(null,n)))}function W(n,m){var v=n.first("wp:docPr").attributes,b=ee(v.descr)?v.title:v.descr,I=G(m);return I===null?Ee([re("Could not find image file for a:blip element")]):Sr(I,b)}function ee(n){return n==null||/^\s*$/.test(n)}function G(n){var m=n.attributes["r:embed"],v=n.attributes["r:link"];if(m)return Rr(m);if(v){var b=i.findTargetByRelationshipId(v);return{path:b,read:c.read.bind(c,b)}}else return null}function Zt(n){var m=n.attributes["r:id"];return m?Sr(Rr(m),n.attributes["o:title"]):Ee([re("A v:imagedata element without a relationship ID was ignored")])}function Rr(n){var m=Br.uriToZipEntryName("word",i.findTargetByRelationshipId(n));return{path:m,read:s.read.bind(s,m)}}function Sr(n,m){var v=o.findContentType(n.path),b=B.Image({readImage:n.read,altText:m,contentType:v}),I=Yn[v]?[]:re("Image of type "+v+" is unlikely to display in web browsers");return Ne(b,I)}function zt(n,m){return re(n+" style with ID "+m+" was referenced but not defined in the document")}}function mt(e,r,t){var a=r.firstOrEmpty("w:ilvl").attributes["w:val"],i=r.firstOrEmpty("w:numId").attributes["w:val"];if(a!==void 0&&i!==void 0)return t.findLevel(i,a);if(e!=null){var o=t.findLevelByParagraphStyleId(e);if(o!=null)return o}return null}var Yn={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},Jn={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function Ee(e){return new _(null,null,e)}function ke(){return new _(null)}function U(e){return new _(e)}function Ne(e,r){return new _(e,null,r)}function _(e,r,t){this.value=e||[],this.extra=r||[],this._result=new ft({element:this.value,extra:r},t),this.messages=this._result.messages}_.prototype.toExtra=function(){return new _(null,Xe(this.extra,this.value),this.messages)};_.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new _(Xe(this.value,e),null,this.messages):this};_.prototype.map=function(e){var r=this._result.map(function(t){return e(t.element)});return new _(r.value,this.extra,r.messages)};_.prototype.flatMap=function(e){var r=this._result.flatMap(function(t){return e(t.element)._result});return new _(r.value.element,Xe(this.extra,r.value.extra),r.messages)};_.map=function(e,r,t){return new _(t(e.value,r.value),Xe(e.extra,r.extra),e.messages.concat(r.messages))};function Mr(e){var r=ft.combine(K.pluck(e,"_result"));return new _(K.flatten(K.pluck(r.value,"element")),K.filter(K.flatten(K.pluck(r.value,"extra")),Qn),r.messages)}function Xe(e,r){return K.flatten([e,r])}function Qn(e){return e}var pt={};pt.DocumentXmlReader=ta;var ea=E,ra=Z.Result;function ta(e){var r=e.bodyReader;function t(a){var i=a.first("w:body");if(i==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var o=r.readXmlElements(i.children).map(function(s){return new ea.Document(s,{notes:e.notes,comments:e.comments})});return new ra(o.value,o.messages)}return{convertXmlToDocument:t}}var Le={};Le.readRelationships=na;Le.defaultValue=new hr([]);Le.Relationships=hr;function na(e){var r=[];return e.children.forEach(function(t){if(t.name==="relationships:Relationship"){var a={relationshipId:t.attributes.Id,target:t.attributes.Target,type:t.attributes.Type};r.push(a)}}),new hr(r)}function hr(e){var r={};e.forEach(function(a){r[a.relationshipId]=a.target});var t={};return e.forEach(function(a){t[a.type]||(t[a.type]=[]),t[a.type].push(a.target)}),{findTargetByRelationshipId:function(a){return r[a]},findTargetsByType:function(a){return t[a]||[]}}}var vr={};vr.readContentTypesFromXml=ia;var aa={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};vr.defaultContentTypes=dt({},{});function ia(e){var r={},t={};return e.children.forEach(function(a){if(a.name==="content-types:Default"&&(r[a.attributes.Extension]=a.attributes.ContentType),a.name==="content-types:Override"){var i=a.attributes.PartName;i.charAt(0)==="/"&&(i=i.substring(1)),t[i]=a.attributes.ContentType}}),dt(t,r)}function dt(e,r){return{findContentType:function(t){var a=e[t];if(a)return a;var i=t.split("."),o=i[i.length-1];if(r.hasOwnProperty(o))return r[o];var s=aa[o.toLowerCase()];return s?"image/"+s:null}}}var je={},Ce=$;je.readNumberingXml=ua;je.Numbering=yr;je.defaultNumbering=new yr({},{});function yr(e,r,t){var a=Ce.flatten(Ce.values(r).map(function(c){return Ce.values(c.levels)})),i=Ce.indexBy(a.filter(function(c){return c.paragraphStyleId!=null}),"paragraphStyleId");function o(c,f){var d=e[c];if(d){var p=r[d.abstractNumId];if(p){if(p.numStyleLink==null)return r[d.abstractNumId].levels[f];var T=t.findNumberingStyleById(p.numStyleLink);return o(T.numId,f)}else return null}else return null}function s(c){return i[c]||null}return{findLevel:o,findLevelByParagraphStyleId:s}}function ua(e,r){if(!r||!r.styles)throw new Error("styles is missing");var t=la(e),a=oa(e);return new yr(a,t,r.styles)}function la(e){var r={};return e.getElementsByTagName("w:abstractNum").forEach(function(t){var a=t.attributes["w:abstractNumId"];r[a]=sa(t)}),r}function sa(e){var r={};e.getElementsByTagName("w:lvl").forEach(function(a){var i=a.attributes["w:ilvl"],o=a.firstOrEmpty("w:numFmt").attributes["w:val"],s=a.firstOrEmpty("w:pStyle").attributes["w:val"];r[i]={isOrdered:o!=="bullet",level:i,paragraphStyleId:s}});var t=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:r,numStyleLink:t}}function oa(e){var r={};return e.getElementsByTagName("w:num").forEach(function(t){var a=t.attributes["w:numId"],i=t.first("w:abstractNumId").attributes["w:val"];r[a]={abstractNumId:i}}),r}var Ue={};Ue.readStylesXml=ca;Ue.Styles=Re;Ue.defaultStyles=new Re({},{});function Re(e,r,t,a){return{findParagraphStyleById:function(i){return e[i]},findCharacterStyleById:function(i){return r[i]},findTableStyleById:function(i){return t[i]},findNumberingStyleById:function(i){return a[i]}}}Re.EMPTY=new Re({},{},{},{});function ca(e){var r={},t={},a={},i={},o={paragraph:r,character:t,table:a};return e.getElementsByTagName("w:style").forEach(function(s){var c=fa(s);if(c.type==="numbering")i[c.styleId]=pa(s);else{var f=o[c.type];f&&(f[c.styleId]=c)}}),new Re(r,t,a,i)}function fa(e){var r=e.attributes["w:type"],t=e.attributes["w:styleId"],a=ma(e);return{type:r,styleId:t,name:a}}function ma(e){var r=e.first("w:name");return r?r.attributes["w:val"]:null}function pa(e){var r=e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:r}}var gr={},da=E,ha=Z.Result;gr.createFootnotesReader=ht.bind(Qr,"footnote");gr.createEndnotesReader=ht.bind(Qr,"endnote");function ht(e,r){function t(o){return ha.combine(o.getElementsByTagName("w:"+e).filter(a).map(i))}function a(o){var s=o.attributes["w:type"];return s!=="continuationSeparator"&&s!=="separator"}function i(o){var s=o.attributes["w:id"];return r.readXmlElements(o.children).map(function(c){return da.Note({noteType:e,noteId:s,body:c})})}return t}var vt={},va=E,ya=Z.Result;function ga(e){function r(a){return ya.combine(a.getElementsByTagName("w:comment").map(t))}function t(a){var i=a.attributes["w:id"];function o(s){return(a.attributes[s]||"").trim()||null}return e.readXmlElements(a.children).map(function(s){return va.comment({commentId:i,body:s,authorName:o("w:author"),authorInitials:o("w:initials")})})}return r}vt.createCommentsReader=ga;var yt={},wa=M;yt.Files=ba;function ba(){function e(r){return wa.reject(new Error("could not open external image: '"+r+`'
cannot open linked files from a web browser`))}return{read:e}}sr.read=Sa;sr._findPartPaths=wt;var Ta=M,Ea=E,nr=Z.Result,Fe=Ie,gt=fr.readXmlFromZipFile,ka=pr.createBodyReader,xa=pt.DocumentXmlReader,he=Le,_r=vr,Fr=je,qr=Ue,Hr=gr,Ra=vt,Ar=yt.Files;function Sa(e,r){return r=r||{},Ta.props({contentTypes:Oa(e),partPaths:wt(e),docxFile:e,files:r.path?Ar.relativeToFile(r.path):new Ar(null)}).also(function(t){return{styles:Na(e,t.partPaths.styles)}}).also(function(t){return{numbering:Pa(e,t.partPaths.numbering,t.styles)}}).also(function(t){return{footnotes:Be(t.partPaths.footnotes,t,function(a,i){return i?Hr.createFootnotesReader(a)(i):new nr([])}),endnotes:Be(t.partPaths.endnotes,t,function(a,i){return i?Hr.createEndnotesReader(a)(i):new nr([])}),comments:Be(t.partPaths.comments,t,function(a,i){return i?Ra.createCommentsReader(a)(i):new nr([])})}}).also(function(t){return{notes:t.footnotes.flatMap(function(a){return t.endnotes.map(function(i){return new Ea.Notes(a.concat(i))})})}}).then(function(t){return Be(t.partPaths.mainDocument,t,function(a,i){return t.notes.flatMap(function(o){return t.comments.flatMap(function(s){var c=new xa({bodyReader:a,notes:o,comments:s});return c.convertXmlToDocument(i)})})})})}function wt(e){return Ca(e).then(function(r){var t=Dr({docxFile:e,relationships:r,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(t))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return ge({filename:bt(t),readElement:he.readRelationships,defaultValue:he.defaultValue})(e).then(function(a){function i(o){return Dr({docxFile:e,relationships:a,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+o,basePath:Fe.splitPath(t).dirname,fallbackPath:"word/"+o+".xml"})}return{mainDocument:t,comments:i("comments"),endnotes:i("endnotes"),footnotes:i("footnotes"),numbering:i("numbering"),styles:i("styles")}})})}function Dr(e){var r=e.docxFile,t=e.relationships,a=e.relationshipType,i=e.basePath,o=e.fallbackPath,s=t.findTargetsByType(a),c=s.map(function(d){return Ia(Fe.joinPath(i,d),"/")}),f=c.filter(function(d){return r.exists(d)});return f.length===0?o:f[0]}function Ia(e,r){return e.substring(0,r.length)===r?e.substring(r.length):e}function ge(e){return function(r){return gt(r,e.filename).then(function(t){return t?e.readElement(t):e.defaultValue})}}function Be(e,r,t){var a=ge({filename:bt(e),readElement:he.readRelationships,defaultValue:he.defaultValue});return a(r.docxFile).then(function(i){var o=new ka({relationships:i,contentTypes:r.contentTypes,docxFile:r.docxFile,numbering:r.numbering,styles:r.styles,files:r.files});return gt(r.docxFile,e).then(function(s){return t(o,s)})})}function bt(e){var r=Fe.splitPath(e);return Fe.joinPath(r.dirname,"_rels",r.basename+".rels")}var Oa=ge({filename:"[Content_Types].xml",readElement:_r.readContentTypesFromXml,defaultValue:_r.defaultContentTypes});function Pa(e,r,t){return ge({filename:r,readElement:function(a){return Fr.readNumberingXml(a,{styles:t})},defaultValue:Fr.defaultNumbering})(e)}function Na(e,r){return ge({filename:r,readElement:qr.readStylesXml,defaultValue:qr.defaultStyles})(e)}var Ca=ge({filename:"_rels/.rels",readElement:he.readRelationships,defaultValue:he.defaultValue}),wr={},Ba=$,$a=M,Se=ne;wr.writeStyleMap=_a;wr.readStyleMap=Ha;var Ma="http://schemas.zwobble.org/mammoth/style-map",qe="mammoth/style-map",Tt="/"+qe;function _a(e,r){return e.write(qe,r),Fa(e).then(function(){return qa(e)})}function Fa(e){var r="word/_rels/document.xml.rels",t="http://schemas.openxmlformats.org/package/2006/relationships",a="{"+t+"}Relationship";return e.read(r,"utf8").then(Se.readString).then(function(i){var o=i.children;Et(o,a,"Id",{Id:"rMammothStyleMap",Type:Ma,Target:Tt});var s={"":t};return e.write(r,Se.writeString(i,s))})}function qa(e){var r="[Content_Types].xml",t="http://schemas.openxmlformats.org/package/2006/content-types",a="{"+t+"}Override";return e.read(r,"utf8").then(Se.readString).then(function(i){var o=i.children;Et(o,a,"PartName",{PartName:Tt,ContentType:"text/prs.mammoth.style-map"});var s={"":t};return e.write(r,Se.writeString(i,s))})}function Et(e,r,t,a){var i=Ba.find(e,function(o){return o.name===r&&o.attributes[t]===a[t]});i?i.attributes=a:e.push(Se.element(r,a))}function Ha(e){return e.exists(qe)?e.read(qe,"utf8"):$a.resolve(null)}var br={},se={},te={},ae={},Wr;function kt(){if(Wr)return ae;Wr=1;var e=Ze();function r(f,d,p){return a(e.element(f,d,{fresh:!1}),p)}function t(f,d,p){var T=e.element(f,d,{fresh:!0});return a(T,p)}function a(f,d){return{type:"element",tag:f,children:d||[]}}function i(f){return{type:"text",value:f}}var o={type:"forceWrite"};ae.freshElement=t,ae.nonFreshElement=r,ae.elementWithTag=a,ae.text=i,ae.forceWrite=o;var s={br:!0,hr:!0,img:!0,input:!0};function c(f){return f.children.length===0&&s[f.tag.tagName]}return ae.isVoidElement=c,ae}var ar,Xr;function Aa(){if(Xr)return ar;Xr=1;var e=$,r=kt();function t(g){return a(d(g))}function a(g){var R=[];return g.map(i).forEach(function(A){f(R,A)}),R}function i(g){return o[g.type](g)}var o={element:s,text:c,forceWrite:c};function s(g){return r.elementWithTag(g.tag,a(g.children))}function c(g){return g}function f(g,R){var A=g[g.length-1];R.type==="element"&&!R.tag.fresh&&A&&A.type==="element"&&R.tag.matchesElement(A.tag)?(R.tag.separator&&f(A.children,r.text(R.tag.separator)),R.children.forEach(function(ue){f(A.children,ue)})):g.push(R)}function d(g){return p(g,function(R){return T[R.type](R)})}function p(g,R){return e.flatten(e.map(g,R),!0)}var T={element:H,text:O,forceWrite:N};function N(g){return[g]}function H(g){var R=d(g.children);return R.length===0&&!r.isVoidElement(g)?[]:[r.elementWithTag(g.tag,R)]}function O(g){return g.value.length===0?[]:[g]}return ar=t,ar}var Lr;function Ve(){if(Lr)return te;Lr=1;var e=kt();te.freshElement=e.freshElement,te.nonFreshElement=e.nonFreshElement,te.elementWithTag=e.elementWithTag,te.text=e.text,te.forceWrite=e.forceWrite,te.simplify=Aa();function r(s,c){c.forEach(function(f){t(s,f)})}function t(s,c){a[c.type](s,c)}var a={element:i,text:o,forceWrite:function(){}};function i(s,c){e.isVoidElement(c)?s.selfClosing(c.tag.tagName,c.tag.attributes):(s.open(c.tag.tagName,c.tag.attributes),r(s,c.children),s.close(c.tag.tagName))}function o(s,c){s.text(c.value)}return te.write=r,te}var jr;function Ze(){if(jr)return se;jr=1;var e=$,r=Ve();se.topLevelElement=t,se.elements=a,se.element=o;function t(c,f){return a([o(c,f,{fresh:!0})])}function a(c){return new i(c.map(function(f){return e.isString(f)?o(f):f}))}function i(c){this._elements=c}i.prototype.wrap=function(f){for(var d=f(),p=this._elements.length-1;p>=0;p--)d=this._elements[p].wrapNodes(d);return d};function o(c,f,d){return d=d||{},new s(c,f,d)}function s(c,f,d){var p={};e.isArray(c)?(c.forEach(function(T){p[T]=!0}),c=c[0]):p[c]=!0,this.tagName=c,this.tagNames=p,this.attributes=f||{},this.fresh=d.fresh,this.separator=d.separator}return s.prototype.matchesElement=function(c){return this.tagNames[c.tagName]&&e.isEqual(this.attributes||{},c.attributes||{})},s.prototype.wrap=function(f){return this.wrapNodes(f())},s.prototype.wrapNodes=function(f){return[r.elementWithTag(this,f)]},se.empty=a([]),se.ignore={wrap:function(){return[]}},se}var Tr={};(function(e){var r=$,t=M,a=Ve();e.imgElement=i;function i(o){return function(s,c){return t.when(o(s)).then(function(f){var d={};return s.altText&&(d.alt=s.altText),r.extend(d,f),[a.freshElement("img",d)]})}}e.inline=e.imgElement,e.dataUri=i(function(o){return o.readAsBase64String().then(function(s){return{src:"data:"+o.contentType+";base64,"+s}})})})(Tr);var xt={},Rt={},St=$;Rt.writer=Da;function Da(e){return e=e||{},e.prettyPrint?Wa():It()}var $e={div:!0,p:!0,ul:!0,li:!0};function Wa(){var e=0,r="  ",t=[],a=!0,i=!1,o=It();function s(O,g){$e[O]&&N(),t.push(O),o.open(O,g),$e[O]&&e++,a=!1}function c(O){$e[O]&&(e--,N()),t.pop(),o.close(O)}function f(O){T();var g=H()?O:O.replace(`
`,`
`+r);o.text(g)}function d(O,g){N(),o.selfClosing(O,g)}function p(){return t.length===0||$e[t[t.length-1]]}function T(){i||(N(),i=!0)}function N(){if(i=!1,!a&&p()&&!H()){o._append(`
`);for(var O=0;O<e;O++)o._append(r)}}function H(){return St.some(t,function(O){return O==="pre"})}return{asString:o.asString,open:s,close:c,text:f,selfClosing:d}}function It(){var e=[];function r(f,d){var p=i(d);e.push("<"+f+p+">")}function t(f){e.push("</"+f+">")}function a(f,d){var p=i(d);e.push("<"+f+p+" />")}function i(f){return St.map(f,function(d,p){return" "+p+'="'+La(d)+'"'}).join("")}function o(f){e.push(Xa(f))}function s(f){e.push(f)}function c(){return e.join("")}return{asString:c,open:r,close:t,text:o,selfClosing:a,_append:s}}function Xa(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function La(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Ot={},ja=$;function Ur(e){return He(e,e)}function He(e,r){return function(){return{start:e,end:r}}}function Ua(e){var r=e.href||"";return r?{start:"[",end:"]("+r+")",anchorPosition:"before"}:{}}function Va(e){var r=e.src||"",t=e.alt||"";return r||t?{start:"!["+t+"]("+r+")"}:{}}function Vr(e){return function(r,t){return{start:t?`
`:"",end:t?"":`
`,list:{isOrdered:e.isOrdered,indent:t?t.indent+1:0,count:0}}}}function Za(e,r,t){r=r||{indent:0,isOrdered:!1,count:0},r.count++,t.hasClosed=!1;var a=r.isOrdered?r.count+".":"-",i=Nt("	",r.indent)+a+" ";return{start:i,end:function(){if(!t.hasClosed)return t.hasClosed=!0,`
`}}}var Pt={p:He("",`

`),br:He("",`  
`),ul:Vr({isOrdered:!1}),ol:Vr({isOrdered:!0}),li:Za,strong:Ur("__"),em:Ur("*"),a:Ua,img:Va};(function(){for(var e=1;e<=6;e++)Pt["h"+e]=He(Nt("#",e)+" ",`

`)})();function Nt(e,r){return new Array(r+1).join(e)}function za(){var e=[],r=[],t=null,a={};function i(p,T){T=T||{};var N=Pt[p]||function(){return{}},H=N(T,t,a);r.push({end:H.end,list:t}),H.list&&(t=H.list);var O=H.anchorPosition==="before";O&&o(T),e.push(H.start||""),O||o(T)}function o(p){p.id&&e.push('<a id="'+p.id+'"></a>')}function s(p){var T=r.pop();t=T.list;var N=ja.isFunction(T.end)?T.end():T.end;e.push(N||"")}function c(p,T){i(p,T),s()}function f(p){e.push(Ka(p))}function d(){return e.join("")}return{asString:d,open:i,close:s,text:f,selfClosing:c}}Ot.writer=za;function Ka(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var Ga=Rt,Ya=Ot;xt.writer=Ja;function Ja(e){return e=e||{},e.outputFormat==="markdown"?Ya.writer():Ga.writer(e)}var ie=$,Zr=M,Me=E,z=Ze(),lr=Z,Qa=Tr,x=Ve(),ei=xt;br.DocumentConverter=ri;function ri(e){return{convertToHtml:function(r){var t=ie.indexBy(r.type===Me.types.document?r.comments:[],"commentId"),a=new ti(e,t);return a.convertToHtml(r)}}}function ti(e,r){var t=1,a=[],i=[];e=ie.extend({ignoreEmptyParagraphs:!0},e);var o=e.idPrefix===void 0?"":e.idPrefix,s=e.ignoreEmptyParagraphs,c=z.topLevelElement("p"),f=e.styleMap||[];function d(u){var h=[],y=T(u,h,{}),w=[];Ct(y,function(S){S.type==="deferred"&&w.push(S)});var k={};return Zr.mapSeries(w,function(S){return S.value().then(function(W){k[S.id]=W})}).then(function(){function S(ee){return ir(ee,function(G){return G.type==="deferred"?k[G.id]:G.children?[ie.extend({},G,{children:S(G.children)})]:[G]})}var W=ei.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return x.write(W,x.simplify(S(y))),new lr.Result(W.asString(),h)})}function p(u,h,y){return ir(u,function(w){return T(w,h,y)})}function T(u,h,y){if(!y)throw new Error("options not set");var w=rr[u.type];return w?w(u,h,y):[]}function N(u,h,y){return H(u,h).wrap(function(){var w=p(u.children,h,y);return s?w:[x.forceWrite].concat(w)})}function H(u,h){var y=A(u);return y?y.to:(u.styleId&&h.push(zr("paragraph",u)),c)}function O(u,h,y){var w=function(){return p(u.children,h,y)},k=[];if(u.highlight!==null){var S=R({type:"highlight",color:u.highlight});S&&k.push(S)}u.isSmallCaps&&k.push(g("smallCaps")),u.isAllCaps&&k.push(g("allCaps")),u.isStrikethrough&&k.push(g("strikethrough","s")),u.isUnderline&&k.push(g("underline")),u.verticalAlignment===Me.verticalAlignment.subscript&&k.push(z.element("sub",{},{fresh:!1})),u.verticalAlignment===Me.verticalAlignment.superscript&&k.push(z.element("sup",{},{fresh:!1})),u.isItalic&&k.push(g("italic","em")),u.isBold&&k.push(g("bold","strong"));var W=z.empty,ee=A(u);return ee?W=ee.to:u.styleId&&h.push(zr("run",u)),k.push(W),k.forEach(function(G){w=G.wrap.bind(G,w)}),w()}function g(u,h){var y=R({type:u});return y||(h?z.element(h,{},{fresh:!1}):z.empty)}function R(u,h){var y=A(u);return y?y.to:h}function A(u){for(var h=0;h<f.length;h++)if(f[h].from.matches(u))return f[h]}function ue(u){return function(h,y){return Zr.attempt(function(){return u(h,y)}).caught(function(w){return y.push(lr.error(w)),[]})}}function oe(u){return le(u.noteType,u.noteId)}function ce(u){return P(u.noteType,u.noteId)}function le(u,h){return L(u+"-"+h)}function P(u,h){return L(u+"-ref-"+h)}function L(u){return o+u}var be=z.elements([z.element("table",{},{fresh:!0})]);function fe(u,h,y){return R(u,be).wrap(function(){return me(u,h,y)})}function me(u,h,y){var w=ie.findIndex(u.children,function(ee){return!ee.type===Me.types.tableRow||!ee.isHeader});w===-1&&(w=u.children.length);var k;if(w===0)k=p(u.children,h,ie.extend({},y,{isTableHeader:!1}));else{var S=p(u.children.slice(0,w),h,ie.extend({},y,{isTableHeader:!0})),W=p(u.children.slice(w),h,ie.extend({},y,{isTableHeader:!1}));k=[x.freshElement("thead",{},S),x.freshElement("tbody",{},W)]}return[x.forceWrite].concat(k)}function Te(u,h,y){var w=p(u.children,h,y);return[x.freshElement("tr",{},[x.forceWrite].concat(w))]}function Qe(u,h,y){var w=y.isTableHeader?"th":"td",k=p(u.children,h,y),S={};return u.colSpan!==1&&(S.colspan=u.colSpan.toString()),u.rowSpan!==1&&(S.rowspan=u.rowSpan.toString()),[x.freshElement(w,S,[x.forceWrite].concat(k))]}function Oe(u,h,y){return R(u,z.ignore).wrap(function(){var w=r[u.commentId],k=i.length+1,S="["+ii(w)+k+"]";return i.push({label:S,comment:w}),[x.freshElement("a",{href:"#"+le("comment",u.commentId),id:P("comment",u.commentId)},[x.text(S)])]})}function Pe(u,h,y){var w=u.label,k=u.comment,S=p(k.body,h,y).concat([x.nonFreshElement("p",{},[x.text(" "),x.freshElement("a",{href:"#"+P("comment",k.commentId)},[x.text("↑")])])]);return[x.freshElement("dt",{id:le("comment",k.commentId)},[x.text("Comment "+w)]),x.freshElement("dd",{},S)]}function j(u,h,y){return er(u).wrap(function(){return[]})}function er(u){var h=A(u);return h?h.to:u.breakType==="line"?z.topLevelElement("br"):z.empty}var rr={document:function(u,h,y){var w=p(u.children,h,y),k=a.map(function(W){return u.notes.resolve(W)}),S=p(k,h,y);return w.concat([x.freshElement("ol",{},S),x.freshElement("dl",{},ir(i,function(W){return Pe(W,h,y)}))])},paragraph:N,run:O,text:function(u,h,y){return[x.text(u.value)]},tab:function(u,h,y){return[x.text("	")]},hyperlink:function(u,h,y){var w=u.anchor?"#"+L(u.anchor):u.href,k={href:w};u.targetFrame!=null&&(k.target=u.targetFrame);var S=p(u.children,h,y);return[x.nonFreshElement("a",k,S)]},checkbox:function(u){var h={type:"checkbox"};return u.checked&&(h.checked="checked"),[x.freshElement("input",h)]},bookmarkStart:function(u,h,y){var w=x.freshElement("a",{id:L(u.name)},[x.forceWrite]);return[w]},noteReference:function(u,h,y){a.push(u);var w=x.freshElement("a",{href:"#"+oe(u),id:ce(u)},[x.text("["+t+++"]")]);return[x.freshElement("sup",{},[w])]},note:function(u,h,y){var w=p(u.body,h,y),k=x.elementWithTag(z.element("p",{},{fresh:!1}),[x.text(" "),x.freshElement("a",{href:"#"+ce(u)},[x.text("↑")])]),S=w.concat([k]);return x.freshElement("li",{id:oe(u)},S)},commentReference:Oe,comment:Pe,image:ai(ue(e.convertImage||Qa.dataUri)),table:fe,tableRow:Te,tableCell:Qe,break:j};return{convertToHtml:d}}var ni=1;function ai(e){return function(r,t,a){return[{type:"deferred",id:ni++,value:function(){return e(r,t,a)}}]}}function zr(e,r){return lr.warning("Unrecognised "+e+" style: '"+r.styleName+"' (Style ID: "+r.styleId+")")}function ir(e,r){return ie.flatten(e.map(r),!0)}function Ct(e,r){e.forEach(function(t){r(t),t.children&&Ct(t.children,r)})}var ii=br.commentAuthorLabel=function(r){return r.authorInitials||""},Bt={},ui=E;function $t(e){if(e.type==="text")return e.value;if(e.type===ui.types.tab)return"	";var r=e.type==="paragraph"?`

`:"";return(e.children||[]).map($t).join("")+r}Bt.convertElementToRawText=$t;var ze={},q={};q.paragraph=li;q.run=si;q.table=oi;q.bold=new Y("bold");q.italic=new Y("italic");q.underline=new Y("underline");q.strikethrough=new Y("strikethrough");q.allCaps=new Y("allCaps");q.smallCaps=new Y("smallCaps");q.highlight=ci;q.commentReference=new Y("commentReference");q.lineBreak=new Ke({breakType:"line"});q.pageBreak=new Ke({breakType:"page"});q.columnBreak=new Ke({breakType:"column"});q.equalTo=mi;q.startsWith=pi;function li(e){return new Y("paragraph",e)}function si(e){return new Y("run",e)}function oi(e){return new Y("table",e)}function ci(e){return new Mt(e)}function Y(e,r){r=r||{},this._elementType=e,this._styleId=r.styleId,this._styleName=r.styleName,r.list&&(this._listIndex=r.list.levelIndex,this._listIsOrdered=r.list.isOrdered)}Y.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||fi(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function Mt(e){e=e||{},this._color=e.color}Mt.prototype.matches=function(e){return e.type==="highlight"&&(this._color===void 0||e.color===this._color)};function Ke(e){e=e||{},this._breakType=e.breakType}Ke.prototype.matches=function(e){return e.type==="break"&&(this._breakType===void 0||e.breakType===this._breakType)};function fi(e,r,t){return e.numbering&&e.numbering.level==r&&e.numbering.isOrdered==t}function mi(e){return{operator:di,operand:e}}function pi(e){return{operator:hi,operand:e}}function di(e,r){return e.toUpperCase()===r.toUpperCase()}function hi(e,r){return r.toUpperCase().indexOf(e.toUpperCase())===0}var _t={},vi=et,yi=vi.RegexTokeniser;_t.tokenise=gi;var Kr="'((?:\\\\.|[^'])*)";function gi(e){var r="(?:[a-zA-Z\\-_]|\\\\.)",t=new yi([{name:"identifier",regex:new RegExp("("+r+"(?:"+r+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(Kr+"'")},{name:"unterminated-string",regex:new RegExp(Kr)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return t.tokenise(e)}var wi=$,l=et,D=q,_e=Ze(),bi=_t.tokenise,ur=Z;ze.readHtmlPath=xi;ze.readDocumentMatcher=ki;ze.readStyle=Ti;function Ti(e){return Er(Bi,e)}function Ei(){return l.rules.sequence(l.rules.sequence.capture(Ft()),l.rules.tokenOfType("whitespace"),l.rules.tokenOfType("arrow"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("whitespace"),l.rules.sequence.capture(qt())).head())),l.rules.tokenOfType("end")).map(function(e,r){return{from:e,to:r.valueOrElse(_e.empty)}})}function ki(e){return Er(Ft(),e)}function Ft(){var e=l.rules.sequence,r=function(P,L){return l.rules.then(l.rules.token("identifier",P),function(){return L})},t=r("p",D.paragraph),a=r("r",D.run),i=l.rules.firstOf("p or r or table",t,a),o=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(Ge)).map(function(P){return{styleId:P}}),s=l.rules.firstOf("style name matcher",l.rules.then(l.rules.sequence(l.rules.tokenOfType("equals"),l.rules.sequence.cut(),l.rules.sequence.capture(de)).head(),function(P){return{styleName:D.equalTo(P)}}),l.rules.then(l.rules.sequence(l.rules.tokenOfType("startsWith"),l.rules.sequence.cut(),l.rules.sequence.capture(de)).head(),function(P){return{styleName:D.startsWith(P)}})),c=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","style-name"),l.rules.sequence.capture(s),l.rules.tokenOfType("close-square-bracket")).head(),f=l.rules.firstOf("list type",r("ordered-list",{isOrdered:!0}),r("unordered-list",{isOrdered:!1})),d=e(l.rules.tokenOfType("colon"),e.capture(f),e.cut(),l.rules.tokenOfType("open-paren"),e.capture(Ri),l.rules.tokenOfType("close-paren")).map(function(P,L){return{list:{isOrdered:P.isOrdered,levelIndex:L-1}}});function p(P){var L=l.rules.firstOf.apply(l.rules.firstOf,["matcher suffix"].concat(P)),be=l.rules.zeroOrMore(L);return l.rules.then(be,function(fe){var me={};return fe.forEach(function(Te){wi.extend(me,Te)}),me})}var T=e(e.capture(i),e.capture(p([o,c,d]))).map(function(P,L){return P(L)}),N=e(l.rules.token("identifier","table"),e.capture(p([o,c]))).map(function(P){return D.table(P)}),H=r("b",D.bold),O=r("i",D.italic),g=r("u",D.underline),R=r("strike",D.strikethrough),A=r("all-caps",D.allCaps),ue=r("small-caps",D.smallCaps),oe=e(l.rules.token("identifier","highlight"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","color"),l.rules.tokenOfType("equals"),l.rules.sequence.capture(de),l.rules.tokenOfType("close-square-bracket")).head()))).map(function(P){return D.highlight({color:P.valueOrElse(void 0)})}),ce=r("comment-reference",D.commentReference),le=e(l.rules.token("identifier","br"),e.cut(),l.rules.tokenOfType("open-square-bracket"),l.rules.token("identifier","type"),l.rules.tokenOfType("equals"),e.capture(de),l.rules.tokenOfType("close-square-bracket")).map(function(P){switch(P){case"line":return D.lineBreak;case"page":return D.pageBreak;case"column":return D.columnBreak}});return l.rules.firstOf("element type",T,N,H,O,g,R,A,ue,oe,ce,le)}function xi(e){return Er(qt(),e)}function qt(){var e=l.rules.sequence.capture,r=l.rules.tokenOfType("whitespace"),t=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","fresh"))),function(s){return s.map(function(){return!0}).valueOrElse(!1)}),a=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","separator"),l.rules.tokenOfType("open-paren"),e(de),l.rules.tokenOfType("close-paren")).head()),function(s){return s.valueOrElse("")}),i=l.rules.oneOrMoreWithSeparator(Ge,l.rules.tokenOfType("choice")),o=l.rules.sequence(e(i),e(l.rules.zeroOrMore(Pi)),e(t),e(a)).map(function(s,c,f,d){var p={},T={};return c.forEach(function(N){N.append&&p[N.name]?p[N.name]+=" "+N.value:p[N.name]=N.value}),f&&(T.fresh=!0),d&&(T.separator=d),_e.element(s,p,T)});return l.rules.firstOf("html path",l.rules.then(l.rules.tokenOfType("bang"),function(){return _e.ignore}),l.rules.then(l.rules.zeroOrMoreWithSeparator(o,l.rules.sequence(r,l.rules.tokenOfType("gt"),r)),_e.elements))}var Ge=l.rules.then(l.rules.tokenOfType("identifier"),Ht),Ri=l.rules.tokenOfType("integer"),de=l.rules.then(l.rules.tokenOfType("string"),Ht),Si={n:`
`,r:"\r",t:"	"};function Ht(e){return e.replace(/\\(.)/g,function(r,t){return Si[t]||t})}var Ii=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.sequence.capture(Ge),l.rules.tokenOfType("equals"),l.rules.sequence.capture(de),l.rules.tokenOfType("close-square-bracket")).map(function(e,r){return{name:e,value:r,append:!1}}),Oi=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(Ge)).map(function(e){return{name:"class",value:e,append:!0}}),Pi=l.rules.firstOf("attribute or class",Ii,Oi);function Er(e,r){var t=bi(r),a=l.Parser(),i=a.parseTokens(e,t);return i.isSuccess()?ur.success(i.value()):new ur.Result(null,[ur.warning(Ni(r,i))])}function Ni(e,r){return"Did not understand this style mapping, so ignored it: "+e+`
`+r.errors().map(Ci).join(`
`)}function Ci(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var Bi=Ei(),Ye={};Ye.readOptions=_i;var At=$,$i=Ye._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],Mi=Ye._standardOptions={transformDocument:Fi,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function _i(e){return e=e||{},At.extend({},Mi,e,{customStyleMap:Gr(e.styleMap),readStyleMap:function(){var r=this.customStyleMap;return this.includeEmbeddedStyleMap&&(r=r.concat(Gr(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(r=r.concat($i)),r}})}function Gr(e){return e?At.isString(e)?e.split(`
`).map(function(r){return r.trim()}).filter(function(r){return r!==""&&r.charAt(0)!=="#"}):e:[]}function Fi(e){return e}var Dt={},Yr=M,qi=Ie;Dt.openZip=Hi;function Hi(e){return e.arrayBuffer?Yr.resolve(qi.openArrayBuffer(e.arrayBuffer)):Yr.reject(new Error("Could not find file in options"))}var we={},Jr=$;we.paragraph=Ai;we.run=Di;we._elements=Xt;we.getDescendantsOfType=Wi;we.getDescendants=Lt;function Ai(e){return Wt("paragraph",e)}function Di(e){return Wt("run",e)}function Wt(e,r){return Xt(function(t){return t.type===e?r(t):t})}function Xt(e){return function r(t){if(t.children){var a=Jr.map(t.children,r);t=Jr.extend(t,{children:a})}return e(t)}}function Wi(e,r){return Lt(e).filter(function(t){return t.type===r})}function Lt(e){var r=[];return jt(e,function(t){r.push(t)}),r}function jt(e,r){e.children&&e.children.forEach(function(t){jt(t,r),r(t)})}var Ut={},Xi=Ze(),Li=Ve();Ut.element=ji;function ji(e){return function(r){return Li.elementWithTag(Xi.element(e),[r])}}var Ui=$,Vt=sr,kr=wr,Vi=br.DocumentConverter,Zi=Bt.convertElementToRawText,zi=ze.readStyle,Ki=Ye.readOptions,Je=Dt,Gi=Z.Result;Q.convertToHtml=Yi;Q.convertToMarkdown=Ji;Q.convert=xr;Q.extractRawText=tu;Q.images=Tr;Q.transforms=we;Q.underline=Ut;Q.embedStyleMap=nu;Q.readEmbeddedStyleMap=Qi;function Yi(e,r){return xr(e,r)}function Ji(e,r){var t=Object.create(r||{});return t.outputFormat="markdown",xr(e,t)}function xr(e,r){return r=Ki(r),Je.openZip(e).tap(function(t){return kr.readStyleMap(t).then(function(a){r.embeddedStyleMap=a})}).then(function(t){return Vt.read(t,e).then(function(a){return a.map(r.transformDocument)}).then(function(a){return eu(a,r)})})}function Qi(e){return Je.openZip(e).then(kr.readStyleMap)}function eu(e,r){var t=ru(r.readStyleMap()),a=Ui.extend({},r,{styleMap:t.value}),i=new Vi(a);return e.flatMapThen(function(o){return t.flatMapThen(function(s){return i.convertToHtml(o)})})}function ru(e){return Gi.combine((e||[]).map(zi)).map(function(r){return r.filter(function(t){return!!t})})}function tu(e){return Je.openZip(e).then(Vt.read).then(function(r){return r.map(Zi)})}function nu(e,r){return Je.openZip(e).tap(function(t){return kr.writeStyleMap(t,r)}).then(function(t){return t.toArrayBuffer()}).then(function(t){return{toArrayBuffer:function(){return t},toBuffer:function(){return Buffer.from(t)}}})}Q.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)};export{Q as l};
