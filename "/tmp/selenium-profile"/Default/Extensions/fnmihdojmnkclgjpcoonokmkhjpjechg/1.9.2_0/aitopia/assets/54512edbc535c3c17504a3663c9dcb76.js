import{p as v,a as w,b as F}from"./6cc4f5807f5417d76ffd6252058f18a5.js";import{A as U,_ as x}from"./1c25847c7fc02d4653adfd0d76358356.js";import{H as P,A as E}from"./5b6d41c8f3d086816edf7147d0e5be66.js";import{F as b}from"./ad7771ba9f1beeaa1011f0407c89d0ed.js";import{d as k,H as C,bH as I,bM as c,a_ as g,aP as f,L as r,bc as m,X as y,aA as A,J as h,I as _}from"./ead41015014512fa5b1aedaebaed4448.js";import"./1a1e12b85f9de6c453175456e6b03dc3.js";import"./989aa6bb6448c33c925f59d410861c78.js";import"./931cef985b47c04f6bedd0a31efd2483.js";import"./2f0ba330a9fe20d9e75da86d9009bc02.js";import"./6e99284c7e89ef9d925f62c5923f9505.js";import"./627790d07d05a1e3f1edac3d8d9e5374.js";import"./5900820d402351b6ced9644caf1aeb74.js";import"./3b977fb3d05d7c837f2c2a36b962aba8.js";import"./38947f350f8ec379fd4ebc6062f2ceb3.js";import"./fa33a1d8cfa1706fa45935e4b38d2e4a.js";import"./a5065ef0d1faee02785346df731c0899.js";import"./a6d0ee077b9cc3485bbd70404dec4c25.js";import"./a917ecdde6f9bd006481134216d18309.js";import"./215b80e923e12745f9ed657e17d445e9.js";import"./5e85fbd0320a36c22ba51601e1fd6d3e.js";import"./0a746d69d1501f25fe490072865698ea.js";import"./b609051c1488d7e4ca471541f0ea26a4.js";import"./01a6239c2b482162212963ea19da43eb.js";import"./4b8810a6f832399ec9a72af40c647dde.js";import"./ee34ee5b9c5753935e961eee233a62fc.js";import"./1c2cb1f3d9fae674ab65fc85b988f036.js";import"./798d77a2cc0b06947e326ec57ac79867.js";import"./7afa0b1c12b13d1626d2f2c8e2aa1ee0.js";import"./95c5528581b0856eaa0cfd2aa93cc17d.js";import"./a2d51818e134dfda6f32266bb36e093e.js";import"./3a41cd8c5af9dd3910506c9a4099ba81.js";import"./88e2aedb43ec1d2e2774299e2ae7941a.js";import"./44b95ac80240ad7543fb4b924bb1567f.js";import"./64c9ab4069ddfd9b3fd37861f0dfe0bc.js";import"./a249de61d26fa0e9c55cd1a997b2f3fc.js";import"./1ef827d78758f1cc260efc1cc487bd6a.js";import"./cb1fabc7deb21c91693028468d48d929.js";import"./827d45c20c7f3dc6bac7505f49c0d43b.js";import"./a0cfba98480a8e27227569d9f5f13dff.js";v.GlobalWorkerOptions.workerSrc=w;const M=async e=>await new Promise((a,o)=>{const n=new FileReader;n.onload=async d=>{var l;if((l=d.target)!=null&&l.result)try{const t=await F.getDocument({data:d.target.result}).promise;let i="";for(let s=1;s<=t.numPages;s++)try{const u=await(await t.getPage(s)).getTextContent();i+=u.items.map(D=>D.str).join(" ")}catch(p){console.log(`Error occurred while reading page ${s}: ${p}`);continue}t.destroy(),a(i)}catch(t){o(`Error occurred while reading PDF file: ${t}`)}else o("No result found")},n.onerror=()=>{o(`Error occurred while reading file: ${n.error}`)},n.readAsArrayBuffer(e)}),S=k({extends:U,name:"PdfUploader",computed:{acceptedFileTypes(){return".pdf,.doc,.docx,.xlsx,.xls,.ppt,.pptx"}},data(){return{pdfUploadErrorMessage:"",pdfUploadPromptId:"",pdfUploadIsProcessing:!1,pdfUploadDragActive:!1}},methods:{async uploadPDF(e){const a=e.target.files[0];await this.processFile(a)},dragOver(e){e.preventDefault(),this.pdfUploadDragActive=!0},dragEnter(e){e.preventDefault(),this.pdfUploadDragActive=!0},dragLeave(e){e.preventDefault(),this.pdfUploadDragActive=!1},async handleDrop(e){const a=e.dataTransfer.files[0];await this.processFile(a)},async processFile(e){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"].includes(e.type)){this.pdfUploadErrorMessage=this.__("Please upload a PDF, Word, Excel, or PowerPoint file");return}this.pdfUploadErrorMessage="",this.pdfUploadIsProcessing=!0;try{let o="";if(e.type!=="application/pdf"){const l=b.getInstance();try{await l.loadPDF(e);const t=l.getPdfDoc();if(!t)throw new Error("Failed to convert file to PDF format");for(let i=1;i<=t.numPages;i++)try{const p=await(await t.getPage(i)).getTextContent();o+=p.items.map(u=>u.str).join(" ")}catch(s){console.log(`Error occurred while reading page ${i}: ${s}`);continue}await l.cleanup()}catch(t){console.error("Error converting file:",t),this.pdfUploadErrorMessage=this.__("Error processing this file format. Please try again or use a PDF file."),this.pdfUploadIsProcessing=!1;return}}else o=await M(e);if(o===""){this.pdfUploadErrorMessage=this.__("Content of the file is empty. Please upload a regular PDF file. Photo converted PDF files cannot be used at ChatPDF"),this.pdfUploadIsProcessing=!1;return}this.changeStorage("settings.web_access",!1,!1),this.pdfUploadPromptId=P.SHA1(this.getFileName(e));const n="",d=e.name;this.newChat(),this.closeModel(),this.changeStorage("settings.ai_model",this.constants.ai_default_model),this.aiChat(o,this.constants.ai_default_model,"ai_chat","__all",!0,!1,d,!1,{is_pdf:!0,prompt_prefix:E.prompt_prefix,language_name:this.settings.language_name}),document.querySelector("#fileInputPDF")!=null&&(document.querySelector("#fileInputPDF").value=null)}catch(o){console.log(o),this.pdfUploadErrorMessage=this.__("Something went wrong. Please try again.")}finally{this.pdfUploadIsProcessing=!1}},getFileName(e){return P.slugify(e.name)},closeModel(){let e=document.querySelector('[data-aifnmjmchg-dropdown-toggle="aifnmjmchg-pdf-upload-modal"]');e&&(this.pdfUploadPromptId="",e.click()),e=document.querySelector("#aifnmjmchg-pdf-upload-modal button[data-modal-hide]"),e&&(this.pdfUploadPromptId="",e.click())}}}),$={class:"aifnmjmchg-p-4 aifnmjmchg-w-full aifnmjmchg-text-center aifnmjmchg-flex aifnmjmchg-flex-col aifnmjmchg-items-center aifnmjmchg-gap-3"},N={class:"aifnmjmchg-px-4 aifnmjmchg-text-sm aifnmjmchg-text-neutral-600 dark:aifnmjmchg-text-neutral-400"},T=["disabled","accept"],B={for:"fileInputPDF",class:"aifnmjmchg-w-full aifnmjmchg-h-full aifnmjmchg-relative aifnmjmchg-z-[9999]"},H={class:"aifnmjmchg-flex aifnmjmchg-flex-col aifnmjmchg-w-full aifnmjmchg-p-6 aifnmjmchg-items-center aifnmjmchg-justify-center aifnmjmchg-mt-4 aifnmjmchg-border-2 aifnmjmchg-border-dotted aifnmjmchg-border-neutral-300 dark:aifnmjmchg-border-neutral-700 aifnmjmchg-rounded-lg aifnmjmchg-text-neutral-600 dark:aifnmjmchg-text-neutral-400 aifnmjmchg-text-center aifnmjmchg-cursor-pointer aifnmjmchg-transition-all hover:aifnmjmchg-opacity-70"},q={class:"aifnmjmchg-flex aifnmjmchg-flex-col aifnmjmchg-items-center aifnmjmchg-gap-1 aifnmjmchg-mt-2"},W={class:"aifnmjmchg-block aifnmjmchg-text-xs"},L={key:0,class:"aifnmjmchg-flex aifnmjmchg-justify-center aifnmjmchg-items-center aifnmjmchg-h-25"},O={class:"aifnmjmchg-h-6"},V={key:0,class:"aifnmjmchg-text-red-500 ai-aifnmjmchgtext-sm"},j={key:0,class:"aifnmjmchg-p-4"};function z(e,a,o,n,d,l){const t=g("svg-logo"),i=g("single-response"),s=g("modal");return f(),C(s,{title:e.__("Upload File"),id:"aifnmjmchg-pdf-upload-modal",className:"aifnmjmchg-items-center",onDrop:c(e.handleDrop,["prevent"]),onDragover:c(e.dragOver,["prevent"]),onDragenter:c(e.dragEnter,["prevent"]),onDragleave:c(e.dragLeave,["prevent"])},{default:I(()=>[r("div",$,[r("p",N,m(e.__("Upload a PDF, Word, Excel, or PowerPoint file to easily get intelligent summaries and answers for your documents.")),1),r("input",{type:"file",id:"fileInputPDF",onChange:a[0]||(a[0]=(...p)=>e.uploadPDF&&e.uploadPDF(...p)),disabled:e.pdfUploadIsProcessing,accept:e.acceptedFileTypes,style:{display:"none"}},null,40,T),r("label",B,[r("div",H,[y(t,{className:"aifnmjmchg-w-16 aifnmjmchg-h-16 aifnmjmchg-opacity-60",name:"file_icon"}),r("div",q,[r("span",W,m(e.__("Supported file types are PDF, Word, Excel, and PowerPoint")),1)]),r("span",{class:A(["aifnmjmchg-block aifnmjmchg-mt-2",e.pdfUploadDragActive?"aifnmjmchg-opacity-100":"aifnmjmchg-opacity-60"])},m(e.pdfUploadDragActive?e.__("Drop your file here"):e.__("Drag your file here or click to upload")),3)])]),e.pdfUploadIsProcessing?(f(),h("div",L,a[1]||(a[1]=[r("div",{class:"aifnmjmchg-border-4 aifnmjmchg-border-solid aifnmjmchg-border-t-transparent aifnmjmchg-border-gray-200 aifnmjmchg-rounded-full aifnmjmchg-w-9 aifnmjmchg-h-9 aifnmjmchg-animate-spin"},null,-1)]))):_("",!0),r("div",O,[e.pdfUploadErrorMessage?(f(),h("p",V,m(e.pdfUploadErrorMessage),1)):_("",!0)])]),this.pdfUploadPromptId?(f(),h("div",j,[y(i,{class:"aifnmjmchg-p-2 aifnmjmchg-rounded-lg aifnmjmchg-bg-neutral-100 dark:aifnmjmchg-bg-neutral-900 dark:aifnmjmchg-text-gray-200",id:"aifnmjmchg-pdf-summary",custom_key:this.pdfUploadPromptId,onContinueChatClick:this.closeModel},null,8,["custom_key","onContinueChatClick"])])):_("",!0)]),_:1},8,["title","onDrop","onDragover","onDragenter","onDragleave"])}const Ae=x(S,[["render",z]]);export{Ae as default};
